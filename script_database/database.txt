# DB CONTROL
CREATE DATABASE CONTROL_LOTTERY CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE CONTROL_LOTTERY;
CREATE TABLE FILE_CONFIGURATION(
    id int primary key auto_increment,
    source varchar(50),
    source_local varchar(50),
    ftp varchar(50),
    user varchar(50),
    pass varchar(50)
);
CREATE TABLE FILE_LOG(
    id int primary key auto_increment,
    id_config int,
    file_name varchar(50),
    date datetime,
    state varchar(10),
    contact int
);
CREATE TABLE contact(
    id int primary key auto_increment,
    student_code varchar(10),
    full_name varchar(50),
    email varchar(50)
);


#insert to config
insert into file_configuration(source, source_local, ftp, user, pass) values('https://xosodaiphat.com/xsmn-xo-so-mien-nam.html', 'E:\\GocHocTap\\eclipse\\Lottery\\output', 'ftp://','luan', 'luan');

#insert to contact
insert into contact(student_code, full_name, email) values('19130131', 'Luong Huu Luan', '19130131@st.hcmuaf.edu.vn');
insert into contact(student_code, full_name, email) values('19130074', 'Nguyen Van Hieu', '19130074@st.hcmuaf.edu.vn');
insert into contact(student_code, full_name, email) values('19130210', 'Ho Thach Thao', '19130210@st.hcmuaf.edu.vn');

#END DB CONTROL

#DB STAGING
CREATE DATABASE STAGING_LOTTERY CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE STAGING_LOTTERY;

CREATE TABLE SOURCE_DIM(
    id_sour int primary key auto_increment,
    name varchar(50),
    url varchar(255)
);
CREATE TABLE DATE_DIM(
     id_date int primary key auto_increment,
     full_date varchar(50),
     day varchar(20),
     date int,
     month int,
     year int
);
CREATE TABLE PROVINCE_DIM(
    id_pro int primary key auto_increment,
    name varchar(50)
);
CREATE TABLE PRIZE_DIM(
     id_pri int primary key auto_increment,
     name varchar(50),
     prize double
);
CREATE TABLE LOTTERY(
     id_lot varchar(100) primary key,
     id_date int,
     id_sour int,
     id_pro int
);
CREATE TABLE RESULT(
     id_lot varchar(100),
     id_pri int,
     result varchar(255)
);

#END DB STAGING

#DB DW
CREATE DATABASE DW_LOTTERY CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE DW_LOTTERY;

CREATE TABLE SOURCE_DIM(
    id_sour int primary key auto_increment,
    name varchar(50),
    url varchar(255)
);
CREATE TABLE DATE_DIM(
     id_date int primary key auto_increment,
     full_date varchar(50),
     day varchar(20),
     date int,
     month int,
     year int
);
CREATE TABLE PROVINCE_DIM(
    id_pro int primary key auto_increment,
    name varchar(50)
);
CREATE TABLE PRIZE_DIM(
     id_pri int primary key auto_increment,
     name varchar(50),
     prize double
);
CREATE TABLE LOTTERY(
     id_lot int primary key auto_increment,
     nk_id_lot varchar(100),
     id_date int,
     id_sour int,
     id_pro int,
     is_delete varchar(5) DEFAULT 'FALSE',
     update_date date DEFAULT CURRENT_TIMESTAMP,
     expried_date date DEFAULT '9999/12/31'
);
CREATE TABLE RESULT(
     id_lot varchar(100),
     id_pri int,
     result varchar(255),
     is_delete varchar(5) DEFAULT 'FALSE',
     update_date date DEFAULT CURRENT_TIMESTAMP,
     expried_date date DEFAULT '9999/12/31'
);

# END DB DW

#insert to province bỏ
insert into province_dim(name) values('Kiên Giang');
insert into province_dim(name) values('Tiền Giang');
insert into province_dim(name) values('Đà Lạt');
insert into province_dim(name) values('TPHCM');
insert into province_dim(name) values('Đồng Tháp');
insert into province_dim(name) values('Cà Mau');
insert into province_dim(name) values('Vũng Tàu');
insert into province_dim(name) values('Bến Tre');
insert into province_dim(name) values('Bạc Liêu');
insert into province_dim(name) values('Sóc Trăng');
insert into province_dim(name) values('Cần Thơ');
insert into province_dim(name) values('An Giang');
insert into province_dim(name) values('Bình Thuận');
insert into province_dim(name) values('Đồng Nai');
insert into province_dim(name) values('Bình Dương');
insert into province_dim(name) values('Tây Ninh');
insert into province_dim(name) values('Vĩnh Long');
insert into province_dim(name) values('Long An');
insert into province_dim(name) values('Trà Vinh');
insert into province_dim(name) values('Bình Phước');
insert into province_dim(name) values('Hậu Giang');

drop database CONTROL_LOTTERY;
drop database STAGING_LOTTERY;
drop database DW_LOTTERY;
